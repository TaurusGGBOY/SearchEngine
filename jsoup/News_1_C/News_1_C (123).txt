定义 用张量表示数据 用计算图搭建神经网络 用会话执行计算图 优化线上的权 重 参数 得到模型 张量 多维数组 列表 阶张量称作标量 表示一个单独的数 举例 阶张量称作向量 表示一个一维数组 举例 阶张量称作矩阵 表示一个二维数组 它可以有 行 列个元素 每个元素可以用行号和列号共同索引到 举例 判断张量是几阶的 就通过张量右边的方括号数 个是 阶 个是 阶 张量可以表示 阶到 阶数组 列表 举例 为 阶 阶 张量的维数 数据类型 的数据类型有 等 实现 的加法 计算图 搭建神经网络的计算过程 是承载一个或多个计算节点的一张图 只搭建网络 不运算 表示输入 分别是 到 和 到 的权重 的结果显示 是一个张量 只搭建承载计算过程的计算图 并没有运算 如果我们想得到运算结果就要用到 会话 了 会话 执行计算图中的节点运算 我们用 结构实现 在 编辑器中运行 会话时 有时会出现 提示 是因为有的电脑可以支持加速指令 但是运行代码时并没有启动这些指令 可以把这些 提示 暂时屏蔽掉 屏蔽方法为进入主目录下的 文件 在 文件中加入这样一句 从而把 提示 等级降低 命令用于重新执行修改的初始化文件 使之立即生效 而不必注销并重新登录 参数 即神经网络线上的权重 用变量表示 随机给初值 生成参数的方法是让 等于 把生成的方式写在括号里 注意 随机种子如果去掉每次生成的随机数将不一致 如果没有特殊要求标准差 均值 随机种子是可以不写的 当我们知道张量 计算图 会话和参数后 我们可以讨论神经网络的实现过程了 步骤 是训练过程 步骤 是使用过程 准备数据集 提取特征 作为输入喂给神经网络 搭建 结构 从输入到输出 先搭建计算图 再用会话执行 大量特征数据喂给 迭代优化 参数 使用训练好的模型预测和分类 由此可见 基于神经网络的机器学习主要分为两个过程 即训练过程和使用过程 训练过程是第一步 第二步 第三步的循环迭代 使用过程是第四步 一旦参数优化完成就可以固定这些参数 实现特定应用了 很多实际应用中 我们会先使用现有的成熟网络结构 喂入新的数据 训练相应模型 判断是否能对喂入的从未见过的新数据作出正确响应 再适当更改网络结构 反复迭代 让机器自动训练参数找出最优结构和参数 以固定专用模型 搭建神经网络模型 让神经网络 实现推理过程 这块引用拿来详细讲解下上图的前向传播例子 生产一批零件 将体积 和重量 位特征 把它们喂入神经网络 当体积和重量这组数据输入神经网络后会得到一个输出 以输入的特征值是 体积 重量 为例 由搭建的神经网络可得 隐藏层节点 同理算得节点 最终计算得到输出层 这便实现了前向传播过程 推导 神经网络共有几层 或当前是第几层网络 都是指的计算层 输入层不是计算层 所以 为第一层网络 第一层 是输入为 矩阵 用 表示输入 是一个 行 列矩阵 表示一次输入一组特征 这组特征包含了 体积和重量两个元素 前节点编号 后节点编号 层数 为待优化的参数 对于第一层的 前面有两个节点 后面有三个节点 应该是个两行三列矩阵 我们这样表示 所以 为第一层网络 是一个一行三列矩阵 我们这样表示 第二层参数要满足前面三个节点 后面一个节点 所以 是三行一列矩阵 我们这样表示 输入层 是输入为 矩阵 表示一次输入一组特征 这组特征包含了 体积 和 重量 两个元素 下编号 节点 上编号 层数 为待优化的参数 参数 的确定 输入层到第一层 参数要满足前面两个节点 后面三个节点 因此应该是个两行三列矩阵 运算后得到的 是一个一行三列矩阵 第一层到输出层 参数要满足前面三个节 点 后面一个节点 所以 是三行一列矩阵 隐藏层 隐藏层的计算 我们把每层输入与线上的权重进行矩阵乘法 这样用矩阵乘法可以计算出输出 了 输出层 想要输出结果 就需要用到 会话 利用 结构来实现 把所有的所有变量初始化过程 计算过程都要放到 函数中 前向传播就是搭建模型的计算过程 让模型具有推理能力 可以针对输入给出相应的输出 用 实现输入定义 中喂入一组数据 的情况 第一组喂体积 重量 用 实现输入定义 中喂入多组数据 的情况第一组喂体积 重量 第二组喂体积 重量 第三组喂体积 重量 第四组喂体积 重量 以输入的特征值是 体积 重量 的例子的实现整体代码如下 这条引用拿来归纳 神经网络的几个基本点 在 中 数据不是以整数 浮点数或者字符串形式存储的 这些值被封装在一个叫做 的对象中 返回的 是一个常量 因为这个 的值不会变 操作 在 的运行时中 它是一种类似 或 或 的运算 张量 表示数据 是一种特定的多维数组 每一个 值在 上都是一个 计算图 描述运算任务 把运算任务描述成一个直接的无环图形 图表中的节点 代表必须要实现的一些操作 图中的边代表数据或者可控的依赖 会话 运行 操作的类 提供在图中执行操作的一些方法 封装了被执行操作和 计算的环境 运行 可以获得你要进行运算的结果 启动图的第一步是创建一个 对象 在实际应用中 我们可以一次喂入一组或多组输入 先用 给输入占位 方便输入的处理 数据类型 喂给 的张量元素的类型 数据形状 表示有 组输入 表示每组输入有 个特征 名称 返回值 张量 类型 一 反向传播 反向传播 训练模型参数 在所有参数上用梯度下降 使 模型在训练数据上的损失函数最小 损失函数 计算得到的预测值 与已知答案 的差距 损失函数的计算有很多方法 均方误差 是比较常用的方法之一 均方误差 求前向传播计算结果与已知答案之差的平方再求平均 反向传播训练方法 以减小 值为优化目标 有梯度下降 优化器 优化器等优化方法 在 中代码表示分别如下 学习率 决定参数每次更新的幅度 代码 背 由神经网络的实现结果 我们可以看出 总共训练 轮 每轮从 的数据集 和 的标签中抽取相对应的从 开始到 结束个特征值和标签 喂入神经网络 用 求出 每 轮打印一次 值 经过 轮后 我们打印出最终训练好的参数 可以修改 看看对 的影响 可以训练次数增大来观察 的减少过程 更改优化器来看看哪一个效果更好 准备 前向传播 反向传播 迭代循环 准备 常量定义 生成或导入数据集 前向传播 定义输入 参数以及输出 定义输入 对应的组数和每组特征数 定义标签 对应的组数和标签特征数 定义输入层到第一层的权重参数 行号要于输入的每组特征数一致 定义第一层到输出层的权重参数 列号要于输出的标签特征数一致 第一层得到的结果 传递给下一层 输出层得到的结果 反向传播 定义损失函数 反向传播方法 迭代循环 生成会话 迭代训练 轮