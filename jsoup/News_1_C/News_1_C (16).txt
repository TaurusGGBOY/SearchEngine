内容参考来自 掘金 美团技术团队的文章 可以自行搜索 代码注入攻击 攻击者通过在目标网站上注入恶意脚本 使之在用户的浏览器上运行 利用这些恶意脚本 攻击者可获取用户的敏感信息如 等 进而危害数据安全 通常页面中包含的用户输入内容都在固定的容器或者属性内 以文本的形式展示 攻击者利用这些页面的用户输入片段 拼接特殊格式的字符串 突破原有位置的限制 形成了代码片段 攻击者通过在目标网站上注入脚本 使之在用户的浏览器上运行 从而引发潜在风险 的本质是 恶意代码未经过滤 与网站正常的代码混在一起 浏览器无法分辨哪些脚本是可信的 导致恶意脚本被执行 由于直接在用户的终端执行 恶意代码能够直接获取用户的信息 或者利用这些信息冒充用户向网站发起攻击者定义的请求 在部分情况下 由于输入的限制 注入的恶意脚本比较短 但可以通过引入外部的脚本 并由浏览器执行 来完成比较复杂的攻击策略 举例说明 特殊的 属性 当浏览器请求 时 服务端会解析出请求参数 得到 拼接到 中返回给浏览器 形成了如下的 通过 转义 可以防止 攻击 按照如下规则进行转义 字符 转义后的字符 开头的字段 代码不会立即执行 但一旦用户点击 标签时 浏览器会就会弹出 做了 转义 并不等于高枕无忧 对于链接跳转 如 或 要检验其内容 禁止以 开头的链接 和其他非法的 其他例子就不举了 攻击有以下注入方法 在处理输入时 以下内容都不可信 根据攻击的来源 攻击可分为存储型 反射型和 型三种 存储型 存储型 的攻击步骤 反射型 反射型 的攻击步骤 反射型 跟存储型 的区别是 存储型 的恶意代码存在数据库里 反射型 的恶意代码存在 里 反射型 漏洞常见于通过 传递参数的功能 如网站搜索 跳转等 由于需要用户主动打开恶意的 才能生效 攻击者往往会结合多种手段诱导用户点击 的内容也可以触发反射型 只不过其触发条件比较苛刻 需要构造表单提交页面 并引导用户点击 所以非常少见 型 型 的攻击步骤 型 跟前两种 的区别 型 攻击中 取出和执行恶意代码由浏览器端完成 属于前端 自身的安全漏洞 而其他两种 都属于服务端的安全漏洞 攻击有两大要素 所以我们可以从以下解决 输入过滤 输入侧过滤能够在某些情况下解决特定的 问题 但会引入很大的不确定性和乱码问题 在防范 攻击时应避免此类方法 当然 对于明确的输入类型 例如数字 电话号码 邮件地址等等内容 进行输入过滤还是必要的 既然输入过滤并非完全可靠 我们就要通过 防止浏览器执行恶意代码 来防范 这部分分为两类 预防 型 攻击 型 攻击 实际上就是网站前端 代码本身不够严谨 把不可信的数据当作代码执行了 其他解决方法 输入内容长度限制 禁止 读取某些敏感 验证码 利用模板引擎开启模板引擎自带的 转义功能 例如 在 中 尽量使用 而不是 在 中 尽量使用 而不是 在 中 确保引擎版本高于 并且选择正确的 避免内联事件 尽量不要使用 这种拼接内联事件的写法 在 中通过 事件绑定会更安全 避免拼接 前端采用拼接 的方法比较危险 如果框架允许 使用 之类的方法实现 或者采用比较成熟的渲染框架 如 等 时刻保持警惕 在插入位置为 属性 链接等位置时 要打起精神 严加防范 增加攻击难度 降低攻击后果 通过 输入长度配置 接口安全措施等方法 增加攻击的难度 降低攻击的后果 主动检测和发现 可使用 攻击字符串和自动扫描工具寻找潜在的 漏洞 跨站请求伪造 挟制用户在当前已登录的 应用程序上执行非本意的操作的攻击方法 攻击者诱导受害者进入第三方网站 在第三方网站中 向被攻击网站发送跨站请求 利用受害者在被攻击网站已经获取的注册凭证 绕过后台的用户验证 达到冒充用户对被攻击的网站执行某项操作的目的 一个典型的 攻击有着如下的流程 类型的 类型的 利用非常简单 只需要一个 请求 一般会这样利用 在受害者访问含有这个 的页面后 浏览器会自动向 发出一次 请求 就会收到包含受害者登录信息的一次跨域请求 类型的 这种类型的 利用起来通常使用的是一个自动提交的表单 如 访问该页面后 表单会自动提交 相当于模拟用户完成了一次 操作 类型的攻击通常比 要求更加严格一点 但仍并不复杂 任何个人网站 博客 被黑客上传页面的网站都有可能是发起攻击的来源 后端接口不能将安全寄托在仅允许 上面 链接类型的 链接类型的 并不常见 比起其他两种用户打开页面就中招的情况 这种需要用户点击链接才会触发 这种类型通常是在论坛中发布的图片中嵌入恶意链接 或者以广告的形式诱导用户中招 攻击者通常会以比较夸张的词语诱骗用户点击 例如 由于之前用户登录了信任的网站 并且保存登录状态 只要用户主动访问上面的这个 页面 则表示攻击成功 的特点 攻击一般发起在第三方网站 而不是被攻击的网站 被攻击的网站无法防止攻击发生 攻击利用受害者在被攻击网站的登录凭证 冒充受害者提交操作 而不是直接窃取数据 整个过程攻击者并不能获取到受害者的登录凭证 仅仅是 冒用 跨站请求可以用各种方式 图片 超链接 提交等等 部分请求方式可以直接嵌入在第三方论坛 文章中 难以进行追踪 同源策略 在 协议中 每一个异步请求都会携带两个 用于标记来源域名 服务器通过校验请求是否携带正确的 来把正常的请求和攻击的请求区分开 也可以防范 的攻击 使用 储存 分三步 将 输出到页面中 页面提交请求携带 服务器验证 是否正确 双重 验证 双重 采用以下流程 在用户访问网站页面时 向请求域名注入一个 内容为随机字符串 例如 在前端向后端发起请求时 取出 并添加到 的参数中 接上例 后端接口验证 中的字段与 参数中的字段是否一致 不一致则拒绝 通过把 命令插入到 表单提交或输入域名或页面请求的查询字符串 最终达到欺骗服务器执行恶意的 命令 防范方法 浏览器自身也在不断在进化和发展 不断引入 等新技术来增强安全性