索引 创建 索引 附加 条件 唯一 非空 类型 索引 创建 数据 类型 字段 唯一索引 创建 索引 索引 值 唯一 类型 索引 快速 查询 条 记录 索引 唯一索引 假设 维护 市民 系统 每个人 有一个 唯一 身份证 号 业务 代码 保证 写入 两个 重复 身份证 号 市民 系统 身份证号 查 姓名 就会 执行 类似 语句 字段 建 索引 身份证 号 字段 建议 身份证 号 当做 主键 两个 选择 字段 创建 唯一索引 创建 索引 业务 代码 保证 写入 重复 身份证 号 两个 选择 逻辑上 都是 正确 思考 性能 角度 选择 唯一索引 索引 选择 依据 又是 深入浅出 索引 中的 例子 假设 字段 值 都不 重复 接下来 这两种 索引 查询 语句 更新 语句 性能 影响 分析 查询 过程 假设 执行 查询 语句 查询 语句 索引 树上 查找 过程 先是 树 树根 层 搜索 叶子 节点 图 中右 下角 数据 页 数据 页 内部 二分法 定位 记录 带来 性能 差距 答案 微乎其微 数据 数据 页 单位 读写 读 一条 记录 记录 本身 磁盘 读出来 页 单位 将其 整体 读入 内存 数据 页 大小 默认 引擎 页 读写 找到 记录 所在 数据 页 都在 内存 索引 来说 多做 那一次 查找 判断 一条 记录 操作 只 指针 寻找 计算 记录 刚好 数据 页 记录 取下 记录 读取 数据 页 操作 稍微 计算 整型 字段 数据 页 放 近 千个 概率 很低 计算 平均 性能 差异 操作 成本 来说 忽略不计 更新过程 索引 唯一索引 更新 语句 性能 影响 先 概念 更新 数据 页 数据 页 内存 中就 更新 数据 页 内存 影响 数据 一致性 前提 更新 操作 缓 从磁 盘中 读入 数据 页 下次 查询 访问 数据 页 数据 页 读入 内存 执行 页 操作 方式 保证 数据 逻辑 正确性 名字 叫作 实际上 持久化 数据 内存 中有 拷贝 也会 写入 磁 盘上 中的 操作 应用到 原 数据 页 最新 过程 称为 访问 数据 页 触发 外 系统 后台 线程 定期 数据库 关闭 过程 也会 执行 操作 更新 操作 先记 录在 减少 读 磁盘 语句 执行 速度 提升 数据 读入 内存 占用 方式 占用 内存 提高 内存 利用率 条件 唯一索引 来说 更新 操作 都要 先 判断 操作 违反 唯一性 约束 插入 记录 就要 先 判断 表中 记录 而这 数据 页 读入 内存 才能 判断 读入 内存 更新 内存 更快 没必要 唯一索引 更新 实际上 索引 内存 无限 增大 大小 参数 动态 设置 参数设置 大小 最多 只能 占用 理解 机制 回过 头 分析 要在 这张 表中 插入 记录 流程 第一 记录 更新 目标 页 内存 流程 这样看来 索引 唯一索引 更新 语句 性能 影响 差别 判断 只会 耗费 微小 关注 重点 记录 更新 目标 页 不在 内存 流程 数据 磁盘 读入 内存 涉及 随机 访问 数据库 成本 操作 减少 随机 磁盘 访问 更新 性能 提升 很明显 现实 事情 有个 同学 负责 业务 库 内存 命中率 降低 系统 处于 阻塞状态 更新 语句 堵住 探 究其 原因 才 业务 插入 数据 操作 前一天 索引 改成 唯一索引 场景 分析 更新过程 加速 作用 只限于 用在 索引 场景 而不 唯一索引 索引 场景 起到 加速 作用 数据 更新 时刻 目的 记录 变更 动作 缓存 数据 页 记录 变更 越多 页面 更新 次数 越多 收益 越大 写 读 少 业务 来说 页面 写完 马上 访问 概率 效果 业务 模型 常见 账单 类 日志 类 系统 假设 业务 更新 模式 写入 马上 会做 查询 条件 更新 先记 录在 马上 访问 数据 页 触发 过程 随机 访问 次数 减少 反而 增加 维护 代价 业务 模式 来说 反而 起到 副作用 索引 选择 实战 回到 索引 唯一索引 选择 两类 索引 查询 能力 没 差别 更新 性能 影响 建议 尽量 选择 索引 更新 马上 伴随着 记录 查询 关闭 都能 提升 更新 性能 索引 配合 数据 量大 表 更新 优化 特别 机械 硬盘 机制 收效 有一个 类似 历史数据 库 出于 成本 机械 硬盘 那你 特别 关注 表里 索引 尽量 索引 尽量 开大 确保 历史数据 表 数据 写入 速度 理解 原理 联想 学习 提升 性能 核心 机制 的确 尽量 减少 随机 读写 两个 概念 确实 混淆 放到 同一个 流程 里来 便于 区分 两个 概念 表上 执行 插入 语句 假设 索引 树 状态 查找 位置 所在 数据 页 内存 所在 数据 页 不在 内存 如图所示 带 更新 状态图 分析 这条 更新 语句 涉及 四个 内存 数据 表空间 系统 表空间 这条 更新 语句 做了 操作 图中 数字 顺序 做完 事务 执行 这条 更新 语句 成本 很低 写 两处 内存 写了 磁盘 两次 操 作合 写 磁盘 顺序 写 图中 两个 虚线 箭头 后台 操作 影响 新的 响应时间 那在这 读 请求 执行 出了 这两个 请求 流程图 图中 读 数据 页 才 会被 读入 内存 简单 对比 这两个 机制 提升 更新 性能 收益 节省 随机 写 磁盘 消耗 转成 顺序 写 节省 则是 随机 读 磁盘 消耗 这次 索引 唯一索引 选择 数据 查询 更新过程 说明了 机制 场景 好讲 到了 索引 选择 实践 唯一索引 用不上 优化 机制 业务 接收 性能 角度 出发 建议 优先 非 唯一索引 补充 思考 更新过程 图 写 内存 机器 掉电 重启 导致 丢失 丢失 事儿 再从 磁盘 读入 数据 过程 等于 数据 丢失 答案 丢失 更新 内存 事务 提交 操作 记录 到了 崩溃 恢复 也能 找回来 给出 执行 流程 过程 结束 这时候 数据 页 内存 磁盘 位置 都还 修改 脏 页 刷 回 物理 数据 过程 
